<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>notification</title>
		<style>
			progress {width: 100%}
			#info {
				color: #888;
				font-size: 12px;
			}
		</style>
		<script>
			function eventListener(port){
				var progress = document.querySelector("progress");
				var info = document.getElementById("info");
				port.onMessage.addListener(function(msg){
					if(msg.err) {
						info.innerText = msg.err;
						return;
					}
					
					progress.value = ~~(msg.progress * 100);
					console.log(progress.value);
					if(progress.value < 100){
						info.innerText = "Now Loading... " + progress.value + "%";
					} else {
						info.innerText = "Complete!";
					}
				});
				chrome.extension.onConnect.removeListener(eventListener);
			};
			
			chrome.extension.onConnect.addListener(eventListener);
		</script>
	</head>
	<body>
		<div id="info">Now Connecting...</div>
		<div><progress max=100 value=0></progress></div>
	</body>
</html>
